(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{420:function(t,s){t.exports="data:image/png;base64,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"},421:function(t,s,a){t.exports=a.p+"assets/img/1684120139487-25d6d748-6f38-4fbe-ab9f-c2d1ec354dbc.754562b3.png"},422:function(t,s,a){t.exports=a.p+"assets/img/1684120161210-57b37374-9a27-4d75-becc-8f4fd8e84441.2ae424dd.png"},558:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("blockquote",[s("p",[t._v("参考：")]),t._v(" "),s("ol",[s("li",[s("a",{attrs:{href:"https://juejin.cn/post/6844904090116292616#heading-6",target:"_blank",rel:"noopener noreferrer"}},[t._v("Proxy 和 Reflect - 掘金"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect/get",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reflect.get() - JavaScript | MDN"),s("OutboundLink")],1)])])]),t._v(" "),s("h4",{attrs:{id:"proxy-只是相当于针对-目标对象-包裹了一层代理。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#proxy-只是相当于针对-目标对象-包裹了一层代理。"}},[t._v("#")]),t._v(" Proxy 只是相当于针对 目标对象 包裹了一层代理。")]),t._v(" "),s("p",[t._v("也就是说，如果我们直接取得其内部的属性引用。那么通过这个引用来执行某个操作，则会出现无法跟踪的现象。")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" originObj "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'originObj-name'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("age")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" proxyObj "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Proxy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("originObj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("receiver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'代理: get'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Reflect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("receiver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" childRef "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" proxyObj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ref "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 访问一次，打印")]),t._v("\n\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'---------------------'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'originObj.name'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" proxyObj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ref"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 访问一次，打印")]),t._v("\n\n\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'childRef.age'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" childRef"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br")])]),s("p",[s("img",{attrs:{src:a(420),alt:"image.png"}})]),t._v(" "),s("p",[t._v("同样的，如果是对 代理的对象的内部对象 设置属性，那么同样不会触发"),s("code",[t._v("set")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" originObj "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'originObj-name'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("age")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" proxyObj "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Proxy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("originObj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'代理: set => '")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Reflect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nproxyObj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'new name'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 打印：代理: set =>  new name")]),t._v("\nproxyObj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ref"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'999'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 没有触发 set")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("h4",{attrs:{id:"为什么在-proxy-捕获器中通常是返回对应-reflect-相同方法。而不是直接返回-target-key-呢"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么在-proxy-捕获器中通常是返回对应-reflect-相同方法。而不是直接返回-target-key-呢"}},[t._v("#")]),t._v(" 为什么在 Proxy 捕获器中通常是返回对应 Reflect 相同方法。而不是直接返回 target[key] 呢？")]),t._v(" "),s("p",[t._v("首先，需要使用 Reflect 来执行操作的是在 "),s("code",[t._v("get(target, key, receiver)")]),t._v("、"),s("code",[t._v("set(target, key, value, receiver)")]),t._v("捕获器中。\n其中 "),s("code",[t._v("get")]),t._v("捕获器参数"),s("code",[t._v("receiver")]),t._v("是指代理的对象，或者 继承自代理对象的对象；"),s("code",[t._v("set")]),t._v("捕获器参数"),s("code",[t._v("receiver")]),t._v("是指原始调用对象。")]),t._v(" "),s("p",[s("img",{attrs:{src:a(421),alt:"image.png"}}),t._v(" "),s("img",{attrs:{src:a(422),alt:"image.png"}}),t._v("\n而 Reflect 的方法签名 和 Proxy捕获器对象的方法签名一一对应。根据 ecma262 规范，调用 "),s("code",[t._v("Reflect.get")]),t._v("、"),s("code",[t._v("Reflect.set")]),t._v("时，如果对应 "),s("code",[t._v("target[key]")]),t._v(" 是访问器属性时，则会将访问器的"),s("code",[t._v("this")]),t._v("绑定到"),s("code",[t._v("receiver")]),t._v("上执行，从而可以保证访问器属性中"),s("code",[t._v("this")]),t._v("的正确指向。\n而有时，Proxy 的捕获器属性需要返回值 true/false 来表示是否成功。而 Reflect 对应方法执行后也会返回相应的布尔值。")]),t._v(" "),s("h4",{attrs:{id:"proxy-的局限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#proxy-的局限"}},[t._v("#")]),t._v(" Proxy 的局限")]),t._v(" "),s("p",[t._v("一些 ECMAScript  内置类型方法 的执行依赖于其内部的槽位。而 Proxy 代理的对象上不存在这个内部槽位，且也无法通过普通的"),s("code",[t._v("get()")]),t._v("、"),s("code",[t._v("set()")]),t._v("访问的。所以 Proxy 无法拦截。")]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("Map")]),t._v("、"),s("code",[t._v("Set")]),t._v("、"),s("code",[t._v("Date")]),t._v("、"),s("code",[t._v("Promise")]),t._v('等都是用到了 "内部槽位"。')])]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" target "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" proxy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Proxy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("proxy "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("instanceof")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n\nproxy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// TypeError")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("h4",{attrs:{id:"可取消的-proxy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#可取消的-proxy"}},[t._v("#")]),t._v(" 可取消的 Proxy")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("proxy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" revoke"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Proxy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("revocable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" handler"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" object "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"data"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("proxy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" revoke"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Proxy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("revocable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("object"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// proxy 正常工作")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("proxy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Valuable data")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 之后某处调用")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("revoke")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// proxy 不再工作（已吊销）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("proxy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Error")]),t._v("\n\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);